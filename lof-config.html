<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
  </head>
  <body>
    <form id='form__main'>
      <div class='row'>
        <div id='fig'>List of figures</div>
          <input id='fig-enabled' name='fig-enabled' type='checkbox'>
          <input id='fig-order' name='fig-order' type='number'>
      </div>
      <div class='row'>
        <div id='tab'>List of tables</div>
          <input id='tab-enabled' name='tab-enabled' type='checkbox'>
          <input id='tab-order' name='tab-order' type='number'>
      </div>
      <input type='submit' name='save' class='actions__button' id='save' value='Save'>
      <input type='button' name='cancel' class='actions__button' id='cancel' value='Cancel'>
    </form>
  </body>
  <script src='//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js'></script>
  <script>
  $('#form__main').submit(function (e) {
    e.preventDefault()
    
    const values = {}
    for (const code of ['fig', 'tab']) {
      if (!$('#' + code + '-enabled').prop('checked')) continue
      values[code] = {'order': parseInt($('#' + code + '-order').val())}
    }
    google.script.run.withSuccessHandler(close).saveLofConfig(values)
  }) 
  
  
  function close() {
    google.script.host.close()
  }
  
  </script>
</html>
