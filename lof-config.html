<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link rel='stylesheet' href='https://ssl.gstatic.com/docs/script/css/add-ons1.css'>
  </head>
  <body>
    <form id='form__main'>
      <div class='row'>
        <div id='fig'>List of figures</div>
          <input id='fig-enabled' name='fig-enabled' type='checkbox'>
          <input id='fig-order' name='fig-order' type='number'>
      </div>
      <div class='row'>
        <div id='tab'>List of tables</div>
          <input id='tab-enabled' name='tab-enabled' type='checkbox'>
          <input id='tab-order' name='tab-order' type='number'>
      </div>
      <input type='submit' name='save' class='actions__button blue' id='save' value='Save'>
      <button class='actions__button' id='cancel' onclick='close()'>Cancel</button>
    </form>
  </body>
  <script src='//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js'></script>
  <script>
    $(function () {
    google.script.run.withSuccessHandler(initialise).getLofConfig()
  })
  
  function initialise(lofSettings) {
    console.log(lofSettings)
    for (const code in lofSettings) {
      $('#' + code + '-enabled').prop('checked', true)
      $('#' + code + '-order').val(lofSettings[code].order)
    }
  }
  
  $('#form__main').submit(function (e) {
    e.preventDefault()
    
    const values = {}
    for (const code of ['fig', 'tab']) {
      if (!$('#' + code + '-enabled').prop('checked')) continue
      values[code] = {'order': parseInt($('#' + code + '-order').val())}
    }
    google.script.run.withSuccessHandler(close).saveLofConfig(values)
  }) 
  
  function close() {
    google.script.host.close()
  }
  
  </script>
</html>
